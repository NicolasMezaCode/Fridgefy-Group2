{"ast":null,"code":"import { collection, getDocs, getFirestore, query, QuerySnapshot, doc, getDoc, onSnapshot, addDoc, setDoc, Timestamp, serverTimestamp, deleteDoc, where, updateDoc } from \"firebase/firestore\";\nimport { deleteObject, getDownloadURL, ref, uploadBytesResumable } from 'firebase/storage';\nimport { dataBase, storage } from './firebase_config';\nimport { useState, useEffect } from \"react\"; //Check ref\n\nexport const recipeRef = collection(dataBase, 'recipes');\nexport const ingredientsRef = collection(dataBase, 'ingredients');\nconsole.log(recipeRef);\nconsole.log(ingredientsRef); //Get query snapshot\n\nexport const recipeQuerySnapShot = () => {\n  getDocs(recipeRef).then(QuerySnapshot => {\n    QuerySnapshot.docs.forEach(doc => console.log(doc.data()));\n  });\n}; //Get the data every time, the database updates\n// const [recipe, setRecipe] = useState([])\n// const onTimeUpdate = (ref) =>{\n//     const updatedData = onSnapshot(ref, (QuerySnapshot)=>{\n//         setRecipe(\n//             QuerySnapshot.doc.map((doc) => ({\n//                 ...doc.data(),\n//                 id: doc.id\n//             }))\n//         )\n//     })\n//     return updatedData;\n// }\n// useEffect(() =>{\n//     onTimeUpdate(ref)\n// }, [])\n\nexport const dataBaseService = {\n  add: async newRecipe => {\n    const {\n      userId,\n      id,\n      image,\n      imageType,\n      title\n    } = newRecipe;\n    const res = await addDoc(recipeRef, newRecipe);\n    console.log(res);\n    return res;\n  },\n  get: async userId => {\n    console.log('userId', userId);\n    const res = await getDocs(recipeRef);\n    console.log('getting', res);\n\n    if (!userId) {\n      return res;\n    }\n\n    ;\n    const recipesFilteredByUserId = query(recipeRef, where('userId', '==', userId));\n    return await getDocs(recipesFilteredByUserId);\n  },\n  delete: async id => {\n    const docRef = doc(dataBase, 'recipes', id);\n    console.log(id);\n    console.log('delete target', docRef); // await deleteDoc(docRef);\n  }\n};","map":{"version":3,"names":["collection","getDocs","getFirestore","query","QuerySnapshot","doc","getDoc","onSnapshot","addDoc","setDoc","Timestamp","serverTimestamp","deleteDoc","where","updateDoc","deleteObject","getDownloadURL","ref","uploadBytesResumable","dataBase","storage","useState","useEffect","recipeRef","ingredientsRef","console","log","recipeQuerySnapShot","then","docs","forEach","data","dataBaseService","add","newRecipe","userId","id","image","imageType","title","res","get","recipesFilteredByUserId","delete","docRef"],"sources":["C:/Users/nicki/Desktop/Web development/React-Proyect/Fridgefy-Group2/src/Backend/FirebaseUtils.js"],"sourcesContent":["import { collection, getDocs, getFirestore, query, QuerySnapshot, doc, getDoc, onSnapshot, addDoc, setDoc, Timestamp, serverTimestamp, deleteDoc, where, updateDoc } from \"firebase/firestore\";\r\n\r\nimport { deleteObject, getDownloadURL, ref, uploadBytesResumable } from 'firebase/storage';\r\nimport { dataBase, storage } from './firebase_config'\r\nimport {useState, useEffect } from \"react\"\r\n\r\n//Check ref\r\nexport const recipeRef = collection(dataBase, 'recipes')\r\nexport const ingredientsRef = collection(dataBase, 'ingredients')\r\nconsole.log(recipeRef)\r\nconsole.log(ingredientsRef)\r\n\r\n//Get query snapshot\r\nexport const recipeQuerySnapShot = () =>{\r\n    getDocs(recipeRef).then((QuerySnapshot) =>{\r\n        QuerySnapshot.docs.forEach((doc) => console.log(doc.data()))\r\n    })\r\n}\r\n\r\n//Get the data every time, the database updates\r\n// const [recipe, setRecipe] = useState([])\r\n// const onTimeUpdate = (ref) =>{\r\n//     const updatedData = onSnapshot(ref, (QuerySnapshot)=>{\r\n//         setRecipe(\r\n//             QuerySnapshot.doc.map((doc) => ({\r\n//                 ...doc.data(),\r\n//                 id: doc.id\r\n//             }))\r\n//         )\r\n//     })\r\n//     return updatedData;\r\n// }\r\n\r\n// useEffect(() =>{\r\n//     onTimeUpdate(ref)\r\n// }, [])\r\n\r\nexport const dataBaseService = {\r\n    add: async (newRecipe) =>{\r\n        const {userId,id, image, imageType, title} = newRecipe;\r\n        const res = await addDoc(recipeRef, newRecipe);\r\n        console.log(res)\r\n        return res\r\n    },\r\n    get: async (userId) =>{\r\n        console.log('userId', userId);\r\n        const res = await getDocs(recipeRef);\r\n        console.log('getting',res);\r\n        if(!userId){\r\n            return res;\r\n        };\r\n        const recipesFilteredByUserId = query(recipeRef, where('userId', '==', userId));\r\n        return await getDocs(recipesFilteredByUserId);\r\n    },\r\n    delete: async (id) =>{\r\n        const docRef = doc(dataBase, 'recipes', id);\r\n        console.log(id)\r\n        console.log('delete target' ,docRef);\r\n        // await deleteDoc(docRef);\r\n    }\r\n}"],"mappings":"AAAA,SAASA,UAAT,EAAqBC,OAArB,EAA8BC,YAA9B,EAA4CC,KAA5C,EAAmDC,aAAnD,EAAkEC,GAAlE,EAAuEC,MAAvE,EAA+EC,UAA/E,EAA2FC,MAA3F,EAAmGC,MAAnG,EAA2GC,SAA3G,EAAsHC,eAAtH,EAAuIC,SAAvI,EAAkJC,KAAlJ,EAAyJC,SAAzJ,QAA0K,oBAA1K;AAEA,SAASC,YAAT,EAAuBC,cAAvB,EAAuCC,GAAvC,EAA4CC,oBAA5C,QAAwE,kBAAxE;AACA,SAASC,QAAT,EAAmBC,OAAnB,QAAkC,mBAAlC;AACA,SAAQC,QAAR,EAAkBC,SAAlB,QAAmC,OAAnC,C,CAEA;;AACA,OAAO,MAAMC,SAAS,GAAGvB,UAAU,CAACmB,QAAD,EAAW,SAAX,CAA5B;AACP,OAAO,MAAMK,cAAc,GAAGxB,UAAU,CAACmB,QAAD,EAAW,aAAX,CAAjC;AACPM,OAAO,CAACC,GAAR,CAAYH,SAAZ;AACAE,OAAO,CAACC,GAAR,CAAYF,cAAZ,E,CAEA;;AACA,OAAO,MAAMG,mBAAmB,GAAG,MAAK;EACpC1B,OAAO,CAACsB,SAAD,CAAP,CAAmBK,IAAnB,CAAyBxB,aAAD,IAAkB;IACtCA,aAAa,CAACyB,IAAd,CAAmBC,OAAnB,CAA4BzB,GAAD,IAASoB,OAAO,CAACC,GAAR,CAAYrB,GAAG,CAAC0B,IAAJ,EAAZ,CAApC;EACH,CAFD;AAGH,CAJM,C,CAMP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;AAEA,OAAO,MAAMC,eAAe,GAAG;EAC3BC,GAAG,EAAE,MAAOC,SAAP,IAAoB;IACrB,MAAM;MAACC,MAAD;MAAQC,EAAR;MAAYC,KAAZ;MAAmBC,SAAnB;MAA8BC;IAA9B,IAAuCL,SAA7C;IACA,MAAMM,GAAG,GAAG,MAAMhC,MAAM,CAACe,SAAD,EAAYW,SAAZ,CAAxB;IACAT,OAAO,CAACC,GAAR,CAAYc,GAAZ;IACA,OAAOA,GAAP;EACH,CAN0B;EAO3BC,GAAG,EAAE,MAAON,MAAP,IAAiB;IAClBV,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBS,MAAtB;IACA,MAAMK,GAAG,GAAG,MAAMvC,OAAO,CAACsB,SAAD,CAAzB;IACAE,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAsBc,GAAtB;;IACA,IAAG,CAACL,MAAJ,EAAW;MACP,OAAOK,GAAP;IACH;;IAAA;IACD,MAAME,uBAAuB,GAAGvC,KAAK,CAACoB,SAAD,EAAYV,KAAK,CAAC,QAAD,EAAW,IAAX,EAAiBsB,MAAjB,CAAjB,CAArC;IACA,OAAO,MAAMlC,OAAO,CAACyC,uBAAD,CAApB;EACH,CAhB0B;EAiB3BC,MAAM,EAAE,MAAOP,EAAP,IAAa;IACjB,MAAMQ,MAAM,GAAGvC,GAAG,CAACc,QAAD,EAAW,SAAX,EAAsBiB,EAAtB,CAAlB;IACAX,OAAO,CAACC,GAAR,CAAYU,EAAZ;IACAX,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BkB,MAA7B,EAHiB,CAIjB;EACH;AAtB0B,CAAxB"},"metadata":{},"sourceType":"module"}